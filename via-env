# disable hashing so via binaries are always used first
set +h

VIA_PREFIX="/opt/via"
VIA_OUTPUT=/gnu/store/aqb7hh3wwqwsm839az1r1snyf2bnf6dz-via-qt-stack-x86_64-via-linux-gnu/via

if [[ ! -L $VIA_PREFIX ]]; then
    echo ERROR: $VIA_PREFIX does not exist
    echo
    echo run the following command to create it
    echo
    echo sudo ln -s $VIA_OUTPUT $VIA_PREFIX
    return 1
fi

if [[ $VIA_ENV ]]; then
    echo Via environment is already setup
    return 0
else
    export PATH="${VIA_PREFIX}/lib/ccache:${VIA_PREFIX}/bin:$PATH"
    export LDFLAGS="-Wl,-rpath -Wl,${VIA_PREFIX}/lib -Wl,--as-needed -Wl,--dynamic-linker,${VIA_PREFIX}/lib/ld-linux-x86-64.so.2"
    export VIA_ENV=true
    echo LDFLAGS: $LDFLAGS
    echo VIA_ENV: $VIA_ENV
    echo
    echo Via enviroment is now setup
    echo
    [[ ! -f ./configure ]] && echo Now generate configure with ./autogen.sh
    [[ ! -f ./config.status ]] && echo And then configure with ./configure
    return 0
fi

# Local Variables:
# mode: sh
# End:
